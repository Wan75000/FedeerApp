<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fish Feeder Dashboard</title>
    <style>
        body { background-color: navy; color: white; text-align: center; font-family: Arial; }
        input, button { margin: 5px; padding: 10px; }
        #screen2 { display: none; }
    </style>
</head>
<body>
    <div id="screen1">
        <h2>Masukkan WiFi</h2>
        <input type="text" id="ssid" placeholder="SSID WiFi">
        <input type="password" id="password" placeholder="Password WiFi">
        <button onclick="connectWiFi()">Konek</button>
    </div>

    <div id="screen2">
        <h2>Fish Feeder</h2>
        <div id="status">Status: Offline</div>
        <button onclick="servoManual()">Manual</button>
        <button onclick="servoAuto()">Otomatis</button>

        <!-- Time Picker untuk setidaknya 3 jadwal pemberian pakan -->
        <div>
            <label for="timePicker1">Jadwal Pakan 1:</label>
            <input type="time" id="timePicker1">
        </div>
        <div>
            <label for="timePicker2">Jadwal Pakan 2:</label>
            <input type="time" id="timePicker2">
        </div>
        <div>
            <label for="timePicker3">Jadwal Pakan 3:</label>
            <input type="time" id="timePicker3">
        </div>

        <button onclick="setSchedule()">Atur Jadwal</button>
        <button onclick="exitApp()">Keluar</button>
    </div>

    <script>
        function connectWiFi() {
            let ssid = document.getElementById('ssid').value;
            let password = document.getElementById('password').value;
            fetch('https://fedeerapp-6d328-default-rtdb.asia-southeast1.firebasedatabase.app/wifi.json', {
                method: 'PUT',
                body: JSON.stringify({ ssid, password }),
                headers: { 'Content-Type': 'application/json' }
            }).then(() => {
                document.getElementById('screen1').style.display = 'none';
                document.getElementById('screen2').style.display = 'block';
            });
        }

        function servoManual() {
            fetch('https://fedeerapp-6d328-default-rtdb.asia-southeast1.firebasedatabase.app/servo.json', {
                method: 'PUT',
                body: JSON.stringify({ mode: "manual", status: "on" })
            });
        }

        function servoAuto() {
            fetch('https://fedeerapp-6d328-default-rtdb.asia-southeast1.firebasedatabase.app/servo.json', {
                method: 'PUT',
                body: JSON.stringify({ mode: "auto" })
            });
        }

        function setSchedule() {
            let time1 = document.getElementById('timePicker1').value;
            let time2 = document.getElementById('timePicker2').value;
            let time3 = document.getElementById('timePicker3').value;

            // Mengirimkan jadwal pemberian pakan ke Firebase
            fetch('https://fedeerapp-6d328-default-rtdb.asia-southeast1.firebasedatabase.app/schedule.json', {
                method: 'PUT',
                body: JSON.stringify([time1, time2, time3]),
                headers: { 'Content-Type': 'application/json' }
            }).then(() => {
                alert("Jadwal pakan berhasil diatur!");
            }).catch((error) => {
                console.error("Error:", error);
                alert("Terjadi kesalahan saat mengatur jadwal.");
            });
        }

        function exitApp() {
            window.location.reload();
        }
    </script>
</body>
</html>
